CREATE TABLE P28(
	[ROWN NUMBER] INT,
	[WORKFLOW] VARCHAR(200),
	STATUS VARCHAR(200)
)

INSERT INTO P28 VALUES(1,'ALPHA', 'PASS'),
(2,' ', 'FAIL'),
(3,' ', 'FAIL'),
(4,' ', 'FAIL'),
(5,'BRAVO', 'PASS'),
(6,' ', 'FAIL'),
(7,' ', 'FAIL'),
(8,' ', 'FAIL'),
(9,' ', 'FAIL'),
(10,'CHARLIE', 'PASS'),
(11,' ', 'FAIL'),
(12,' ', 'FAIL')

WITH CTE ([ROWN NUMBER], WORKFLOW, STATUS, [NEXT], [LAST])
AS
(
	SELECT [ROWN NUMBER], WORKFLOW, STATUS, LEAD([ROWN NUMBER],1,-1) OVER (ORDER BY [ROWN NUMBER]) [NEXT], LAG([ROWN NUMBER],1,-1)  OVER (ORDER BY [ROWN NUMBER]) [LAST]
	FROM
	(
		SELECT [ROWN NUMBER], WORKFLOW, STATUS FROM P28 WHERE STATUS = 'PASS'
	)T
	UNION ALL
	SELECT B.[ROWN NUMBER], A.WORKFLOW, B.STATUS, A.[NEXT], A.[LAST] FROM CTE A JOIN P28 B ON A.[STATUS] <> B.[STATUS] AND B.[ROWN NUMBER] < A.[NEXT] AND A.[STATUS] = 'PASS' AND B.[ROWN NUMBER]>A.[ROWN NUMBER]
)SELECT [ROWN NUMBER], WORKFLOW, STATUS FROM CTE ORDER BY [ROWN NUMBER]