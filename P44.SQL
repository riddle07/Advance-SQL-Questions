CREATE TABLE P44(
	[CUSTOMER ID] INT,
	[BALANCE DATE] DATE,
	AMOUNT MONEY
);

INSERT INTO
	P44
VALUES
(1001, '10/11/2021', $ 54.32),
	(1001, '10/10/2021', $ 17.65),
	(1001, '9/8/2021', $ 65.56),
	(1001, '9/12/2021', $ 56.23),
	(1001, '9/1/2021', $ 42.12),
	(2002, '10/15/2021', $ 46.52),
(2002, '10/13/2021', $ 7.65);

SELECT
	[CUSTOMER ID],
	[BALANCE DATE] [START DATE],
	DATEADD(
		DAY,
		-1,
		LAG([BALANCE DATE], 1, CAST('31/12/9999' AS DATE)) OVER(
			PARTITION BY [CUSTOMER ID]
			ORDER BY
				[BALANCE DATE]
		)
	) [END DATE],
	AMOUNT
FROM
	P44;
