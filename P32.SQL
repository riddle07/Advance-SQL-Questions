CREATE TABLE P32(
	[SPACEMAN ID] INT,
	[JOB DESCRIPTION] VARCHAR(255),
	[MISSION COUNT] INT
);

INSERT INTO
	P32
VALUES
(1001, 'ASTROLOGER', 6),
	(2002, 'ASTROLOGER', 12),
	(3003, 'ASTROLOGER', 17),
	(4004, 'GEOLOGIST', 21),
	(6006, 'GEOLOGIST', 8),
	(7007, 'TECHNICIAN', 13),
	(8008, 'TECHNICIAN', 2),
	(9009, 'TECHNICIAN', 7);

SELECT
	DISTINCT [JOB DESCRIPTION],
	LAST_VALUE([SPACEMAN ID]) OVER(
		PARTITION BY [JOB DESCRIPTION]
		ORDER BY
			[MISSION COUNT] RANGE BETWEEN UNBOUNDED PRECEDING
			AND UNBOUNDED FOLLOWING
	) [MOST EXPERIENCED],
	FIRST_VALUE([SPACEMAN ID]) OVER(
		PARTITION BY [JOB DESCRIPTION]
		ORDER BY
			[MISSION COUNT]
	) [LEAST EXPERIENCED]
FROM
	P32;