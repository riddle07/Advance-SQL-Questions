CREATE TABLE P36(
	[ROUTE ID] INT,
	[DEPARTURE CITY] VARCHAR(200),
	[ARRIVAL CITY] VARCHAR(200),
	COST INT
)

INSERT INTO P36 VALUES (1, 'AUSTIN', 'DALLAS', 100),
(1,'DALLAS', 'AUSTIN', 100),
(2,'DALLAS', 'MEMPHIS', 200),
(2,'MEMPHIS', 'DALLAS', 200),
(3, 'MEMPHIS', 'DES MONIES', 300),
(3,'DES MONIES', 'MEMPHIS', 300),
(4,'DALLAS', 'DES MONIES', 400),
(4, 'DES MONIES', 'DALLAS', 400)

DROP TABLE P36

WITH CTE([PATH], [ARRIVAL CITY], COST)
AS
(
	SELECT CAST([DEPARTURE CITY]+'-->'+[ARRIVAL CITY] AS VARCHAR(200)), [ARRIVAL CITY], COST FROM P36 WHERE [DEPARTURE CITY] = 'AUSTIN'
	UNION ALL
	SELECT CAST(A.[PATH]+'-->'+B.[ARRIVAL CITY] AS VARCHAR(200)), B.[ARRIVAL CITY], A.[COST]+B.[COST] FROM CTE A JOIN P36 B ON A.[ARRIVAL CITY] = B.[DEPARTURE CITY] AND CHARINDEX(B.[ARRIVAL CITY], A.[PATH]) = 0
)SELECT PATH, COST FROM CTE WHERE [ARRIVAL CITY] = 'DES MONIES'