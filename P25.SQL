CREATE TABLE P25(
	[ORDER ID] INT,
	[CUSTOMER ID] INT,
	[ORDER COUNT] INT,
	VENDOR VARCHAR(255)
);

INSERT INTO
	P25
VALUES
(1, 1001, 12, 'DIRECT PARRTS'),
	(2, 1001, 54, 'DIRECT PARTS'),
	(3, 1001, 32, 'ACME'),
	(4, 2002, 7, 'ACME'),
	(5, 2002, 16, 'ACME'),
	(6, 2002, 5, 'DIRECT PARTS');

SELECT
	DISTINCT [CUSTOMER ID],
	FIRST_VALUE(VENDOR) OVER(
		PARTITION BY [CUSTOMER ID]
		ORDER BY
			[ORDER COUNT] DESC
	) [CUSTOMER ID]
FROM
	(
		SELECT
			VENDOR,
			[CUSTOMER ID],
			SUM([ORDER COUNT]) [ORDER COUNT]
		FROM
			P25
		GROUP BY
			VENDOR,
			[CUSTOMER ID]
	) T