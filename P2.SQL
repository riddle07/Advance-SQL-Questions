CREATE TABLE P2(
	EMPLOYEEID INT,
	MANAGERID INT,
	JOBTITLE VARCHAR(20)
)

DROP TABLE P2

INSERT INTO P2 VALUES (1001, NULL, 'PRESIDENT'),
(2002, 1001, 'DIRECTOR'),
(3003, 1001, 'OFFICE MANAGER'),
(4004, 2002, 'ENGINEER'),
(5005, 2002, 'ENGINEER'),
(6006, 2002, 'ENGINEER')

SELECT * FROM P2
WITH CTE(EMPLOYEEID, MANAGERID, JOBTITLE, DEPTH) AS
(
	SELECT EMPLOYEEID, MANAGERID, JOBTITLE, 0 
	FROM P2 WHERE MANAGERID IS NULL
	UNION ALL
	SELECT B.EMPLOYEEID, B.MANAGERID, B.JOBTITLE, A.DEPTH+1 FROM CTE A JOIN P2 B ON B.MANAGERID = A.EMPLOYEEID
)SELECT * FROM CTE